---
version: "3.1.0"
last_updated: "2025-11-12"
status: "draft"
owner: "Engineering Team"
category: "development-process"
change_type: "major - 設計フェーズの分割と実行順序の明確化"
---

# 改訂版 開発プロセス概要 / Revised Development Process Overview

## 📋 変更概要

### 主要変更点

**変更前**: Phase 2 (設計) - 単一フェーズ、実装前に実施
**変更後**: Phase 2.1 (事前設計) + Phase 2.2 (詳細設計) - 実行順序を明確化

### Phase番号と実行順序の関係

```yaml
重要な注意:
  phase_2_1:
    phase_number: "Phase 2.1"
    execution_order: "Phase 1 の後、Phase 3 の前"
    timing: "実装開始前"
  
  phase_2_2:
    phase_number: "Phase 2.2"
    execution_order: "Phase 4 の後、Phase 5 の前"
    timing: "実装完了後 (または Phase 3-4 と並行)"
```

**Phase 2.2 は Phase 4 の後に実行されます**

### 変更の目的

1. **AI開発の特性を活かす**: 早期実装による高速検証サイクル
2. **手戻りの削減**: 実装後の確定情報に基づく詳細設計
3. **並行作業の実現**: 実装とドキュメント化の並行化によるリードタイム短縮
4. **柔軟性の向上**: プロジェクトタイプに応じた適切なアプローチ選択

---

## 🔄 改訂版開発ライフサイクル

### フェーズ全体像（実行順序）

```
実行順序 → Phase番号 → フェーズ名

1. Phase 0: 要件分析・企画 (Requirements & Planning)
   期間: 1-2週間
   ↓
2. Phase 1: プロジェクト初期化 (Project Initialization)
   期間: 1-3日
   ↓
3. Phase 2.1: 事前設計 (Pre-Implementation Design) ★NEW
   期間: 1-2日
   目的: 実装の方向性を定める最小限の設計
   別名: Preliminary Design
   ↓
4. Phase 3: 実装 (Implementation)
   期間: 1-4週間
   ↓
5. Phase 4: レビュー・QA (Review & QA)
   期間: 3-5日
   ↓
6. Phase 2.2: 詳細設計 (Post-Implementation Design) ★NEW
   期間: 2-3日
   目的: 実装内容の文書化と設計の整理
   別名: Detailed Design
   実行順序: Phase 4 の後（または Phase 3-4 と並行）
   ↓
7. Phase 5: デプロイメント (Deployment)
   期間: 数時間～1日
   ↓
8. Phase 6: 運用・保守 (Operations & Maintenance)
   期間: 継続的
```

### フェーズ実行戦略の選択

プロジェクトタイプに応じて3つの実行パターンから選択:

#### **パターンA: AI最適化型** (推奨・デフォルト)

**実行順序**:
```
Phase 0 → Phase 1 → Phase 2.1 (事前設計 1-2日)
                        ↓
                   Phase 3 (実装 1-4週間)
                        ↓
                   Phase 4 (レビュー・QA 3-5日)
                        ↓
              Phase 2.2 (詳細設計 2-3日)
              ※Phase 3-4 と並行実施も可能
                        ↓
                   Phase 5 → Phase 6
```

**タイミング詳細**:
- Phase 2.1: 実装開始前に実施
- Phase 2.2: Phase 3 実装中に並行開始、Phase 4 完了時に完成
  - Week 1-2: Phase 3 実装中に 20-30% 進行
  - Week 3: Phase 4 レビュー中に 30-40% 進行
  - Phase 4 完了後: 残り 30-40% 完成

**適用**: 新規マイクロサービス、AI主導開発、中小規模プロジェクト

**効果**: リードタイム20%短縮、手戻り30%削減

---

#### **パターンB: 従来型** (事前詳細設計)

**実行順序**:
```
Phase 0 → Phase 1 → Phase 2.1 (事前設計 1-2日)
                        ↓
                   Phase 2.2 (詳細設計 3-5日)
                   ※実装前に詳細設計を完成
                        ↓
                   Phase 3 (実装 1-4週間)
                        ↓
                   Phase 4 (レビュー・QA 3-5日)
                        ↓
              Phase 2.2 更新 (1日)
              ※実装との差分を反映
                        ↓
                   Phase 5 → Phase 6
```

**タイミング詳細**:
- Phase 2.1: 実装開始前
- Phase 2.2: 実装開始前に詳細設計を完成
- Phase 2.2 更新: 実装完了後に最終版に更新

**適用**: 複数チーム連携、セキュリティクリティカル、大規模プロジェクト

**効果**: リスク低減、事前合意による手戻り防止

---

#### **パターンC: リバースエンジニアリング型**

**実行順序**:
```
Phase 0 → Phase 1 → Phase 3 (実装 1-4週間)
              ※Phase 2.1 をスキップ
                        ↓
                   Phase 4 (レビュー・QA 3-5日)
                        ↓
              Phase 2.2 (詳細設計 1-2日)
              ※簡易版または省略可能
                        ↓
                   Phase 5 → Phase 6
```

**タイミング詳細**:
- Phase 2.1: スキップ
- Phase 2.2: Phase 4 完了後に実装内容を文書化

**適用**: 小規模改修、技術検証、PoC

**効果**: 最速開始、検証優先

---

## 📐 Phase 2.1: 事前設計 (Pre-Implementation Design)

### 実行タイミング

```yaml
execution_order:
  phase_number: "Phase 2.1"
  after: "Phase 1 (プロジェクト初期化)"
  before: "Phase 3 (実装)"
  timing: "実装開始前"
  duration: "1-2日"
```

### 目的

実装開始前に必要最小限の設計を行い、以下を明確化する:
- アーキテクチャの方向性
- 重要な技術決定
- チーム間の契約(API等)
- 制約条件(セキュリティ、パフォーマンス)

### 期間

- **目標**: 1-2日
- **最大**: 3日

### 成果物 (Deliverables)

#### 必須成果物

| # | 成果物名 | テンプレート | 内容 | ページ数目安 |
|---|---------|------------|------|------------|
| 1 | **ADR (Architecture Decision Record)** | `adr-template.md` | 重要な技術決定の記録 | 1-3ページ/決定 |
| 2 | **API契約書 (API Contract)** | `api-contract-template.md` | エンドポイント一覧と基本的な入出力定義 | 2-5ページ |
| 3 | **制約条件文書 (Constraints Document)** | `constraints-template.md` | セキュリティ、パフォーマンス、技術制約 | 1-2ページ |

#### 推奨成果物 (条件付き)

| # | 成果物名 | 作成条件 | 内容 |
|---|---------|---------|------|
| 4 | **技術提案書 (簡易版)** | 承認が必要な場合 | 技術アプローチの承認取得 |
| 5 | **アーキテクチャ概要図** | 新規システム | システム全体の構成図 |
| 6 | **データモデル概要** | DB変更がある場合 | 主要エンティティとリレーション |

### 完了基準

```yaml
completion_criteria:
  - [ ] 重要な技術決定がADRに記録されている
  - [ ] API契約書が作成され、関係チームと合意されている
  - [ ] 制約条件が明確に定義されている
  - [ ] 実装チームが Phase 3 を開始できる状態である
  - [ ] テックリードの承認を得ている

next_phase:
  - Phase 3 (実装) に進む
```

---

## 📝 Phase 2.2: 詳細設計 (Post-Implementation Design)

### 実行タイミング

```yaml
execution_order:
  phase_number: "Phase 2.2"
  after: "Phase 4 (レビュー・QA)"
  before: "Phase 5 (デプロイメント)"
  timing_options:
    option_1_parallel: "Phase 3-4 と並行実施 (推奨)"
    option_2_after: "Phase 4 完了後に実施"
  duration: "2-3日"

重要:
  "Phase 2.2 という番号だが、実行順序は Phase 4 の後"
  "Phase 3 実装中から並行開始し、Phase 4 完了時に完成させる"
```

### 目的

実装完了後(または並行)に、以下を文書化する:
- 実装された内容の詳細設計
- アーキテクチャの確定版
- 技術的意思決定の記録
- 保守・運用のための情報

### 期間

```yaml
parallel_execution:
  phase_3_during: "Phase 3 期間の 20-30%"
  phase_4_during: "Phase 4 期間の 30-40%"
  total: "実装期間内に完了"

after_execution:
  standalone: "2-3日"
```

### 成果物 (Deliverables)

#### 必須成果物

| # | 成果物名 | テンプレート | 内容 | ページ数目安 |
|---|---------|------------|------|------------|
| 1 | **設計書 (Design Document)** | `design-document-template.md` | 詳細な技術設計の文書化 | 10-30ページ |
| 2 | **完全版API仕様書** | `api-specification-template.md` | 全エンドポイントの詳細仕様 | 10-50ページ |
| 3 | **アーキテクチャ図** | (Diagrams.net等) | システム構成の完全版 | 5-10図 |
| 4 | **データモデル文書** | `data-model-template.md` | ER図、スキーマ定義、マイグレーション | 5-15ページ |

#### 推奨成果物

| # | 成果物名 | 作成条件 | 内容 |
|---|---------|---------|------|
| 5 | **更新版ADR** | 実装中に決定事項がある場合 | 追加の技術決定記録 |
| 6 | **設計レビュー記録** | 正式レビューを実施した場合 | レビュー結果と対応記録 |
| 7 | **パフォーマンステスト結果** | 性能要件がクリティカル | ベンチマーク結果と分析 |
| 8 | **セキュリティ評価書** | セキュリティレビュー実施 | 脆弱性分析と対策 |

### 完了基準

```yaml
completion_criteria:
  prerequisites:
    - [ ] Phase 3 (実装) が完了している
    - [ ] Phase 4 (レビュー・QA) が完了または進行中
    - [ ] コードが安定している
  
  deliverables:
    - [ ] 設計書が完成している
    - [ ] 完全版API仕様書が完成している
    - [ ] アーキテクチャ図が完成している
    - [ ] データモデル文書が完成している
  
  quality:
    - [ ] 実装内容と完全に一致している
    - [ ] 新メンバーのオンボーディングに使える
    - [ ] 運用チームが必要な情報を得られる
  
  approval:
    - [ ] テックリードの承認を得ている

next_phase:
  - Phase 5 (デプロイメント) に進む
```

---

## 🔀 実行順序の明確化

### パターンA: AI最適化型の詳細フロー

```
Week 0: Phase 2.1 (事前設計 1-2日)
  └─ 成果物: ADR, API契約, 制約条件
      ↓
Week 1-2: Phase 3 (実装)
  ├─ メイン作業: 実装 (80%)
  └─ 並行作業: Phase 2.2 開始 (20%)
      - 完成部分から順次文書化
      - アーキテクチャ図の作成開始
      ↓
Week 3: Phase 4 (レビュー・QA)
  ├─ メイン作業: レビュー・テスト (70%)
  └─ 並行作業: Phase 2.2 継続 (30%)
      - API仕様書の完成
      - データモデル文書の作成
      ↓
Week 3 終了時: Phase 2.2 完了
  └─ 全ての設計ドキュメントが完成
      ↓
Week 4: Phase 5 (デプロイメント)
```

### パターンB: 従来型の詳細フロー

```
Week 0: Phase 2.1 (事前設計 1-2日)
  └─ 成果物: ADR, API契約, 制約条件
      ↓
Week 1: Phase 2.2 (詳細設計 3-5日) ※実装前
  └─ 成果物: 設計書, API仕様書, 図, データモデル (初版)
      ↓
Week 2-3: Phase 3 (実装)
  └─ 設計書を参照しながら実装
      ↓
Week 4: Phase 4 (レビュー・QA)
  └─ 実装との整合性確認
      ↓
Week 4 終了時: Phase 2.2 更新 (1日)
  └─ 実装との差分を反映し、最終版を作成
      ↓
Week 5: Phase 5 (デプロイメント)
```

### パターンC: リバースエンジニアリング型の詳細フロー

```
Week 1-2: Phase 3 (実装)
  └─ Phase 2.1 スキップ、直接実装
      ↓
Week 3: Phase 4 (レビュー・QA)
  └─ テストとレビュー
      ↓
Week 3-4: Phase 2.2 (詳細設計 1-2日) ※実装後
  └─ 実装された内容を文書化 (簡易版)
      ↓
Week 4: Phase 5 (デプロイメント)
```

---

## 📊 成果物サマリー

### Phase 2.1 (事前設計) の成果物

**実行タイミング**: Phase 1 の後、Phase 3 の前

| 成果物 | 必須/推奨 | ページ数 | 作成時間 | 目的 |
|--------|----------|---------|---------|------|
| ADR | 必須 | 1-3 | 2-4時間 | 重要な技術決定の記録 |
| API契約書 | 必須 | 2-5 | 2-4時間 | チーム間の契約定義 |
| 制約条件文書 | 必須 | 1-2 | 1-2時間 | 非機能要件の明確化 |
| 技術提案書(簡易版) | 推奨 | 3-5 | 2-3時間 | 承認取得 |
| アーキテクチャ概要図 | 推奨 | 1-2図 | 1-2時間 | システム構成の可視化 |

**合計作成時間**: 8-15時間 (1-2日)

---

### Phase 2.2 (詳細設計) の成果物

**実行タイミング**: Phase 4 の後 (または Phase 3-4 と並行)

| 成果物 | 必須/推奨 | ページ数 | 作成時間 | 目的 |
|--------|----------|---------|---------|------|
| 設計書 | 必須 | 10-30 | 8-16時間 | 詳細技術設計の文書化 |
| 完全版API仕様書 | 必須 | 10-50 | 4-8時間 | 全エンドポイント仕様 |
| アーキテクチャ図 | 必須 | 5-10図 | 4-6時間 | システム構成の完全版 |
| データモデル文書 | 必須 | 5-15 | 4-8時間 | ER図、スキーマ定義 |
| 更新版ADR | 推奨 | 1-3 | 1-2時間 | 追加の技術決定 |

**合計作成時間**: 21-40時間 (3-5日)
**AI活用時**: 10-20時間 (1.5-3日)

---

## 🎯 プロジェクトタイプ別の推奨パターンと実行順序

### 新規マイクロサービス開発

**推奨パターン**: AI最適化型 (パターンA)

**実行順序**:
1. Phase 2.1 (1-2日) → ADR, API契約, 制約条件
2. Phase 3 (1-4週間) → 実装
3. Phase 4 (3-5日) → レビュー・QA
4. Phase 2.2 (並行 or 直後) → 設計書, API仕様書, 図, データモデル
5. Phase 5 → デプロイ

---

### 複数チーム連携プロジェクト

**推奨パターン**: 従来型 (パターンB)

**実行順序**:
1. Phase 2.1 (1-2日) → ADR, API契約, 制約条件
2. Phase 2.2 (3-5日) → 詳細設計 (実装前に完成)
3. Phase 3 (1-4週間) → 実装
4. Phase 4 (3-5日) → レビュー・QA
5. Phase 2.2 更新 (1日) → 最終版に更新
6. Phase 5 → デプロイ

---

### 小規模機能追加

**推奨パターン**: リバースエンジニアリング型 (パターンC)

**実行順序**:
1. Phase 3 (1-2週間) → 実装 (Phase 2.1 スキップ)
2. Phase 4 (2-3日) → レビュー・QA
3. Phase 2.2 (1日) → 簡易版設計書 (必要に応じて)
4. Phase 5 → デプロイ

---

## 📚 関連ドキュメント

### Phase 2.1 詳細ガイド
- `phase-2.1-pre-implementation-design-guide.md` (旧名: phase-2a)
- 実行タイミング: Phase 1 の後、Phase 3 の前

### Phase 2.2 詳細ガイド
- `phase-2.2-post-implementation-design-guide.md` (旧名: phase-2b)
- 実行タイミング: Phase 4 の後 (または Phase 3-4 と並行)

### 成果物マトリクス
- `revised-design-deliverables-matrix.md`

---

## ⚠️ 重要な注意事項

### Phase番号と実行順序の違いに注意

```yaml
注意:
  phase_2_2:
    phase_number: "Phase 2.2"
    description: "番号は2だが、実際は Phase 4 の後に実行される"
    reason: "設計フェーズの一部だが、実装後に実施するため"
    
実行順序の覚え方:
  "Phase 2.1 → Phase 3 → Phase 4 → Phase 2.2 → Phase 5"
  "事前設計 → 実装 → レビュー → 詳細設計 → デプロイ"
```

### チェックリストでの確認

各フェーズ開始前に、前提条件を確認:

```yaml
phase_2_1_start:
  - [ ] Phase 1 が完了している
  - [ ] 要件定義が明確である

phase_3_start:
  - [ ] Phase 2.1 が完了している
  - [ ] ADR, API契約, 制約条件が準備できている

phase_2_2_start:
  - [ ] Phase 3 が完了している (並行の場合は主要機能が完成)
  - [ ] Phase 4 が進行中または完了している
  - [ ] コードが安定している
```

---

## 🚀 次のステップ

### 組織標準への統合

1. **AI-MASTER-WORKFLOW-GUIDE.md** の改訂
   - Phase 2.1 / Phase 2.2 の説明追加
   - 実行順序の明確化

2. **phase-guides/** の更新
   - phase-2a → phase-2.1 にリネーム
   - phase-2b → phase-2.2 にリネーム
   - 各ガイドに実行順序を明記

3. **テンプレート作成**
   - api-contract-template.md (新規)
   - constraints-template.md (新規)

---

**この改訂により、実行順序が明確な開発プロセスを実現します。**
