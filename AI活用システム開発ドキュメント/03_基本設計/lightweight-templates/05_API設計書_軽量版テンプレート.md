# API設計書（Phase 2.1 軽量版）

## ⚠️ Phase 2.1 軽量版について

このテンプレートは**Phase 2.1（実装前）**用の軽量版です。  
- **目的**: API構造の妥当性確認、主要エンドポイントの特定
- **記載レベル**: 主要エンドポイントと基本的なリクエスト/レスポンス
- **省略項目**: 全エンドポイント詳細、詳細なエラーコード、認証詳細

Phase 3（実装）完了後、**Phase 2.2で完全版に更新**してください。

---

## 📋 ドキュメント情報

| 項目 | 内容 |
|------|------|
| プロジェクト名 | [プロジェクト名] |
| システム名 | [システム名] |
| 作成日 | YYYY-MM-DD |
| 作成者 | [作成者名] |
| Phase | 2.1（軽量版・実装前） |
| バージョン | 0.1（軽量版） |

---

## 1. API概要

### 1.1 APIの基本情報

| 項目 | 内容 |
|------|------|
| APIタイプ | [例: RESTful API / GraphQL] |
| ベースURL | [例: https://api.example.com/v1] |
| 認証方式 | [例: JWT / OAuth 2.0 / API Key] |
| データ形式 | [例: JSON / XML] |

**軽量版のため省略**: 詳細な認証フロー、レート制限、バージョニング戦略

---

## 2. 主要エンドポイント一覧

### 2.1 エンドポイントリスト（概要）

| No | メソッド | エンドポイント | 説明 | 認証 |
|----|----------|----------------|------|------|
| 1 | POST | /auth/login | ログイン | 不要 |
| 2 | GET | /users/{id} | ユーザー情報取得 | 必要 |
| 3 | GET | /posts | 投稿一覧取得 | 必要 |
| 4 | POST | /posts | 投稿作成 | 必要 |
| 5 | PUT | /posts/{id} | 投稿更新 | 必要 |
| 6 | DELETE | /posts/{id} | 投稿削除 | 必要 |

**軽量版のため省略**: 全エンドポイント、マイナーなエンドポイント

---

## 3. 主要エンドポイント詳細

### 3.1 [エンドポイント1]（例: POST /auth/login）

#### 概要
ユーザー認証を行い、アクセストークンを発行します。

#### リクエスト

**メソッド**: POST  
**パス**: /auth/login

**リクエストボディ（例）**:
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

#### レスポンス

**成功時（200 OK）**:
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 1,
    "email": "user@example.com",
    "name": "John Doe"
  }
}
```

**エラー時（401 Unauthorized）**:
```json
{
  "error": "Invalid credentials"
}
```

**軽量版のため省略**: 詳細なフィールド説明、全エラーコード、バリデーションルール

---

### 3.2 [エンドポイント2]（例: GET /posts）

#### 概要
投稿の一覧を取得します。

#### リクエスト

**メソッド**: GET  
**パス**: /posts

**クエリパラメータ（例）**:
- `page`: ページ番号（デフォルト: 1）
- `limit`: 1ページあたりの件数（デフォルト: 10）

#### レスポンス

**成功時（200 OK）**:
```json
{
  "data": [
    {
      "id": 1,
      "title": "Sample Post",
      "content": "This is a sample post.",
      "author_id": 1,
      "created_at": "2025-11-14T10:00:00Z"
    }
  ],
  "pagination": {
    "page": 1,
    "limit": 10,
    "total": 100
  }
}
```

**軽量版のため省略**: 全フィールドの詳細説明、ソートパラメータ、フィルタリング詳細

---

### 3.3 [エンドポイント3]（例: POST /posts）

#### 概要
新しい投稿を作成します。

#### リクエスト

**メソッド**: POST  
**パス**: /posts

**ヘッダー**:
- `Authorization`: Bearer {token}

**リクエストボディ（例）**:
```json
{
  "title": "New Post",
  "content": "This is the content of the new post."
}
```

#### レスポンス

**成功時（201 Created）**:
```json
{
  "id": 101,
  "title": "New Post",
  "content": "This is the content of the new post.",
  "author_id": 1,
  "created_at": "2025-11-14T10:00:00Z"
}
```

**エラー時（400 Bad Request）**:
```json
{
  "error": "Validation failed",
  "details": ["Title is required"]
}
```

**軽量版のため省略**: 全バリデーションルール、詳細なエラーコード一覧

---

## 4. 共通仕様（概要）

### 4.1 認証

**方式**: JWT Bearer Token

**ヘッダー例**:
```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**軽量版のため省略**: トークン有効期限、リフレッシュトークン詳細

---

### 4.2 エラーレスポンス（概要）

| ステータスコード | 説明 |
|------------------|------|
| 200 | 成功 |
| 201 | 作成成功 |
| 400 | リクエストエラー |
| 401 | 認証エラー |
| 404 | リソース未検出 |
| 500 | サーバーエラー |

**軽量版のため省略**: 全てのエラーコード、詳細なエラーメッセージ一覧

---

## 5. API実現可能性の確認

### 5.1 API設計チェックリスト

- [ ] 主要なCRUD操作が網羅されているか？
- [ ] RESTful設計原則に従っているか？
- [ ] 認証・認可の仕組みは適切か？
- [ ] レスポンス形式は一貫性があるか？
- [ ] 主要なエラーハンドリングが考慮されているか？

### 5.2 技術的リスク（概要）

| リスク | 影響 | 対策（概要） |
|--------|------|--------------|
| [リスク項目] | [影響度] | [対策方針] |

---

## 6. Phase 2.2での更新項目（メモ）

Phase 3（実装）完了後、以下の項目を完全版で追加：
- [ ] 全エンドポイントの詳細仕様
- [ ] 全フィールドの詳細説明（型、制約、デフォルト値）
- [ ] 全エラーコード一覧とエラーメッセージ
- [ ] 詳細なバリデーションルール
- [ ] レート制限の詳細
- [ ] 認証・認可フローの詳細
- [ ] WebSocket等のリアルタイム通信仕様（該当する場合）
- [ ] API使用例（サンプルコード）

---

## 📝 作成ガイド

### このテンプレートの記入方法

1. **エンドポイント**: 主要なもののみ記載（全てのエンドポイントは不要）
2. **リクエスト/レスポンス**: サンプルレベルで十分（全フィールド不要）
3. **エラーコード**: 主要なもののみ（詳細な一覧は不要）
4. **認証**: 方式のみ記載（詳細フローは不要）

### 記載時間の目安
- **Phase 2.1（軽量版）**: 2〜3時間
- **Phase 2.2（完全版への更新）**: 4〜6時間

---

## 🔄 更新履歴

| バージョン | Phase | 日付 | 変更内容 | 変更者 |
|------------|-------|------|----------|--------|
| 0.1 | 2.1（軽量版） | YYYY-MM-DD | 初版作成（軽量版） | [作成者名] |
| 1.0 | 2.2（完全版） | YYYY-MM-DD | 実装結果を反映し完全版に更新 | [作成者名] |

---

**Phase**: 2.1（軽量版・実装前）  
**次のステップ**: Phase 3（実装）へ  
**Phase 2.2での更新**: 実装完了後、完全版に更新
