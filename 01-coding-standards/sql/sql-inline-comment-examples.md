# SQL ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¡ãƒ³ãƒˆå®Ÿè£…ä¾‹

## ğŸ“– æ¦‚è¦

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€SQLå›ºæœ‰ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¡ãƒ³ãƒˆè¨˜è¿°ã®å…·ä½“ä¾‹ã‚’æä¾›ã—ã¾ã™ã€‚

**å…±é€šåŸå‰‡**: [00-inline-comment-standards.md](../00-inline-comment-standards.md)ã‚’å¿…ãšå‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## ğŸ¯ SQLç‰¹æœ‰ã®ã‚³ãƒ¡ãƒ³ãƒˆå ´é¢

### 1. DDLï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ï¼‰

```sql
-- âŒ æ‚ªã„ä¾‹: ã‚«ãƒ©ãƒ ã®æ„å‘³ãŒä¸æ˜
CREATE TABLE users (
    id BIGINT PRIMARY KEY,
    email VARCHAR(255),
    status VARCHAR(20)
);

-- âœ… è‰¯ã„ä¾‹: å„ã‚«ãƒ©ãƒ ã®ç›®çš„ã¨ãƒ“ã‚¸ãƒã‚¹æ„å‘³ã‚’èª¬æ˜
CREATE TABLE users (
    -- ã€ä¸»ã‚­ãƒ¼ã€‘ãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼ˆè‡ªå‹•æ¡ç•ªï¼‰
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    
    -- ã€å¿…é ˆãƒ»ä¸€æ„ã€‘ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆãƒ­ã‚°ã‚¤ãƒ³IDï¼‰
    -- ç†ç”±: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä¸€æ„ã«è­˜åˆ¥ã™ã‚‹
    email VARCHAR(255) NOT NULL UNIQUE,
    
    -- ã€å¿…é ˆã€‘ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
    -- å€¤: 'active'ï¼ˆã‚¢ã‚¯ãƒ†ã‚£ãƒ–ï¼‰, 'inactive'ï¼ˆä¼‘çœ ï¼‰, 'suspended'ï¼ˆåœæ­¢ï¼‰
    -- ç†ç”±: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆçŠ¶æ…‹ã‚’ç®¡ç†ã—ã€åœæ­¢ä¸­ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ã‚°ã‚¤ãƒ³ã‚’é˜²ã
    status VARCHAR(20) NOT NULL DEFAULT 'active',
    
    -- ã€ä»»æ„ã€‘æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³æ—¥æ™‚
    -- NULLè¨±å¯ã®ç†ç”±: æ–°è¦ç™»éŒ²ç›´å¾Œã¯ãƒ­ã‚°ã‚¤ãƒ³å±¥æ­´ãªã—
    last_login TIMESTAMP NULL,
    
    -- ã€è‡ªå‹•è¨­å®šã€‘ä½œæˆæ—¥æ™‚ï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ™‚ã«è‡ªå‹•è¨­å®šï¼‰
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    
    -- ã€è‡ªå‹•æ›´æ–°ã€‘æ›´æ–°æ—¥æ™‚ï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ™‚ã«è‡ªå‹•æ›´æ–°ï¼‰
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

---

### 2. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

```sql
-- âŒ æ‚ªã„ä¾‹: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ç›®çš„ãŒä¸æ˜
CREATE INDEX idx_users_email ON users(email);

-- âœ… è‰¯ã„ä¾‹: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆã®ç†ç”±ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ¹æœã‚’èª¬æ˜
-- ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€‘ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹æ¤œç´¢ç”¨
-- ç†ç”±: ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†ã§ email ã«ã‚ˆã‚‹æ¤œç´¢ãŒé »ç¹ã«ç™ºç”Ÿ
-- åŠ¹æœ: æ¤œç´¢æ™‚é–“ã‚’ O(n) â†’ O(log n) ã«æ”¹å–„ï¼ˆ100ä¸‡ä»¶ã§ 1000ms â†’ 10msï¼‰
-- æ³¨æ„: UNIQUEã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã—ã¦ä½œæˆï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ä¸€æ„æ€§ã‚’ä¿è¨¼ï¼‰
CREATE UNIQUE INDEX idx_users_email ON users(email);

-- è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä¾‹
-- ã€è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€‘ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ + æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³æ—¥æ™‚
-- ç†ç”±: ã€Œã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³ãŒå¤ã„é †ã€ã®æ¤œç´¢ãŒé »ç¹ã«ç™ºç”Ÿ
-- ã‚¯ã‚¨ãƒªä¾‹: SELECT * FROM users WHERE status = 'active' ORDER BY last_login ASC
-- ã‚«ãƒ©ãƒ é †ã®ç†ç”±: statusï¼ˆã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ä½ï¼‰â†’ last_loginï¼ˆã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£é«˜ï¼‰
CREATE INDEX idx_users_status_last_login ON users(status, last_login);
```

---

### 3. è¤‡é›‘ãªã‚¯ã‚¨ãƒª

```sql
-- âŒ æ‚ªã„ä¾‹: è¤‡é›‘ãªã‚¯ã‚¨ãƒªã«èª¬æ˜ãŒãªã„
SELECT u.id, u.name, COUNT(o.id) as order_count
FROM users u
LEFT JOIN orders o ON u.id = o.user_id AND o.status = 'completed'
WHERE u.created_at >= DATE_SUB(NOW(), INTERVAL 30 DAY)
GROUP BY u.id, u.name
HAVING COUNT(o.id) >= 5;

-- âœ… è‰¯ã„ä¾‹: ã‚¯ã‚¨ãƒªã®ç›®çš„ã¨å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æ„å›³ã‚’èª¬æ˜
-- ã€ã‚¯ã‚¨ãƒªç›®çš„ã€‘éå»30æ—¥é–“ã«ç™»éŒ²ã—ãŸã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æŠ½å‡º
-- ãƒ“ã‚¸ãƒã‚¹è¦ä»¶: æ–°è¦ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä¸­ã§ã€è³¼å…¥å›æ•°5å›ä»¥ä¸Šã®ãƒ­ã‚¤ãƒ¤ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç‰¹å®š

-- FROMå¥: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åŸºæº–ã¨ã™ã‚‹
-- ç†ç”±: ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¯¾è±¡ï¼ˆæ³¨æ–‡ãŒãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚‚å«ã‚€ï¼‰
SELECT 
    u.id,
    u.name,
    -- å®Œäº†ã—ãŸæ³¨æ–‡ã®ä»¶æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
    -- NULLï¼ˆæ³¨æ–‡ãªã—ï¼‰ã¯0ã¨ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆ
    COUNT(o.id) as order_count
FROM users u

-- LEFT JOIN: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç´ã¥ãæ³¨æ–‡ã‚’å–å¾—
-- LEFT JOINã®ç†ç”±: æ³¨æ–‡ãŒãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚‚çµæœã«å«ã‚ã‚‹
-- AND o.status = 'completed' ã®ç†ç”±: å®Œäº†ã—ãŸæ³¨æ–‡ã®ã¿ã‚’ã‚«ã‚¦ãƒ³ãƒˆï¼ˆã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒ»è¿”å“ã‚’é™¤å¤–ï¼‰
LEFT JOIN orders o 
    ON u.id = o.user_id 
    AND o.status = 'completed'

-- WHEREå¥: éå»30æ—¥é–“ã«ç™»éŒ²ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã«çµã‚Šè¾¼ã¿
-- DATE_SUB(NOW(), INTERVAL 30 DAY) ã§30æ—¥å‰ã®æ—¥æ™‚ã‚’è¨ˆç®—
WHERE u.created_at >= DATE_SUB(NOW(), INTERVAL 30 DAY)

-- GROUP BY: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«é›†è¨ˆ
GROUP BY u.id, u.name

-- HAVINGå¥: è³¼å…¥å›æ•°5å›ä»¥ä¸Šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿æŠ½å‡º
-- WHEREã§ã¯ãªãHAVINGã‚’ä½¿ã†ç†ç”±: COUNT()ã¯é›†ç´„é–¢æ•°ã®ãŸã‚ã€HAVINGã§æ¡ä»¶æŒ‡å®š
HAVING COUNT(o.id) >= 5;
```

---

### 4. ã‚µãƒ–ã‚¯ã‚¨ãƒª

```sql
-- âŒ æ‚ªã„ä¾‹: ã‚µãƒ–ã‚¯ã‚¨ãƒªã®æ„å›³ãŒä¸æ˜
SELECT * FROM users 
WHERE id IN (SELECT user_id FROM orders WHERE total_amount > 10000);

-- âœ… è‰¯ã„ä¾‹: ã‚µãƒ–ã‚¯ã‚¨ãƒªã®ç›®çš„ã¨ä»£æ›¿æ¡ˆã‚’èª¬æ˜
-- ã€ã‚¯ã‚¨ãƒªç›®çš„ã€‘é«˜é¡è³¼å…¥è€…ï¼ˆ1ä¸‡å††ä»¥ä¸Šã®æ³¨æ–‡å±¥æ­´ã‚ã‚Šï¼‰ã‚’æŠ½å‡º
-- 
-- ã‚µãƒ–ã‚¯ã‚¨ãƒªã®èª¬æ˜:
-- å†…éƒ¨ã‚¯ã‚¨ãƒªã§ total_amount > 10000 ã®æ³¨æ–‡ã‚’ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å–å¾—ã—ã€
-- å¤–éƒ¨ã‚¯ã‚¨ãƒªã§ãã‚Œã‚‰ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—
-- 
-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®:
-- - INå¥ã®ã‚µãƒ–ã‚¯ã‚¨ãƒªã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ãŒå¤šã„å ´åˆï¼ˆ10ä¸‡ä»¶è¶…ï¼‰ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæ‚ªåŒ–
-- - EXISTSå¥ã¾ãŸã¯ JOIN ã§ã®æ›¸ãæ›ãˆã‚’æ¤œè¨ï¼ˆæ¬¡å›ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°äºˆå®šï¼‰
-- 
-- ä»£æ›¿æ¡ˆï¼ˆJOINç‰ˆï¼‰:
-- SELECT DISTINCT u.* 
-- FROM users u 
-- INNER JOIN orders o ON u.id = o.user_id 
-- WHERE o.total_amount > 10000;
SELECT * 
FROM users 
WHERE id IN (
    SELECT user_id 
    FROM orders 
    WHERE total_amount > 10000
);
```

---

## ğŸ”¢ è¤‡é›‘ãªã‚¯ã‚¨ãƒªã®ä¾‹

### ä¾‹1: ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é–¢æ•°

```sql
-- ã€ã‚¯ã‚¨ãƒªç›®çš„ã€‘å„éƒ¨ç½²ã®å£²ä¸Šãƒˆãƒƒãƒ—3ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æŠ½å‡º
-- 
-- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ç†ç”±:
-- - éƒ¨ç½²ã”ã¨ã«ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’è¨ˆç®—ã—ã€ãƒˆãƒƒãƒ—3ã®ã¿ã‚’æŠ½å‡º
-- - GROUP BYã§ã¯å®Ÿç¾ã§ããªã„ï¼ˆå„è¡Œã«ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’ä»˜ä¸ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼‰
-- 
-- ROW_NUMBER() vs RANK() ã®é¸æŠ:
-- - ROW_NUMBER(): åŒç‡ãŒã‚ã‚‹å ´åˆã€ä»»æ„ã®é †åºã§1ä½ã€2ä½ã€3ä½ã¨å‰²ã‚Šå½“ã¦ã‚‹
-- - RANK(): åŒç‡ãŒã‚ã‚‹å ´åˆã€åŒã˜é †ä½ã‚’å‰²ã‚Šå½“ã¦ã€æ¬¡ã®é †ä½ã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼ˆ1ä½ã€1ä½ã€3ä½ï¼‰
-- æœ¬ã‚¯ã‚¨ãƒªã§ã¯ ROW_NUMBER() ã‚’ä½¿ç”¨ï¼ˆåŒç‡ã®å ´åˆã‚‚3åã‚’ç¢ºå®Ÿã«é¸å‡ºï¼‰

WITH ranked_users AS (
    SELECT 
        u.id,
        u.name,
        u.department_id,
        d.department_name,
        SUM(o.total_amount) as total_sales,
        -- éƒ¨ç½²ã”ã¨ã«å£²ä¸Šã§ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’è¨ˆç®—
        -- PARTITION BY department_id: éƒ¨ç½²ã”ã¨ã«é›†è¨ˆã‚’ãƒªã‚»ãƒƒãƒˆ
        -- ORDER BY SUM(o.total_amount) DESC: å£²ä¸Šã®å¤šã„é †
        ROW_NUMBER() OVER (
            PARTITION BY u.department_id 
            ORDER BY SUM(o.total_amount) DESC
        ) as rank_in_department
    FROM users u
    INNER JOIN departments d ON u.department_id = d.id
    INNER JOIN orders o ON u.id = o.user_id
    WHERE o.status = 'completed'  -- å®Œäº†ã—ãŸæ³¨æ–‡ã®ã¿
    GROUP BY u.id, u.name, u.department_id, d.department_name
)
-- ãƒˆãƒƒãƒ—3ã®ã¿ã‚’æŠ½å‡º
SELECT *
FROM ranked_users
WHERE rank_in_department <= 3
ORDER BY department_id, rank_in_department;
```

---

### ä¾‹2: å†å¸°ã‚¯ã‚¨ãƒªï¼ˆçµ„ç¹”éšå±¤ï¼‰

```sql
-- ã€ã‚¯ã‚¨ãƒªç›®çš„ã€‘ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é…ä¸‹ã«ã„ã‚‹ã™ã¹ã¦ã®éƒ¨ä¸‹ã‚’å–å¾—ï¼ˆéšå±¤æ§‹é€ ï¼‰
-- 
-- å†å¸°CTEã‚’ä½¿ç”¨ã™ã‚‹ç†ç”±:
-- - çµ„ç¹”éšå±¤ã¯æ·±ã•ãŒä¸å®šï¼ˆ2éšå±¤ã®å ´åˆã‚‚5éšå±¤ã®å ´åˆã‚‚ã‚ã‚‹ï¼‰
-- - å†å¸°ã‚¯ã‚¨ãƒªã‚’ä½¿ã†ã“ã¨ã§ã€ä»»æ„ã®æ·±ã•ã®éšå±¤ã‚’å–å¾—å¯èƒ½
-- 
-- å†å¸°ã®æµã‚Œ:
-- 1. ã‚¢ãƒ³ã‚«ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼: èµ·ç‚¹ã¨ãªã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆID=1ï¼‰ã‚’å–å¾—
-- 2. å†å¸°ãƒ¡ãƒ³ãƒãƒ¼: å‰å›å–å¾—ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç›´å±ã®éƒ¨ä¸‹ã‚’å–å¾—
-- 3. éƒ¨ä¸‹ãŒã„ãªããªã‚‹ã¾ã§ç¹°ã‚Šè¿”ã™

WITH RECURSIVE subordinates AS (
    -- ã‚¢ãƒ³ã‚«ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼: èµ·ç‚¹ã¨ãªã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼
    -- manager_id = 1 ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ID=1ã®ç›´å±ã®éƒ¨ä¸‹ï¼‰
    SELECT 
        id,
        name,
        manager_id,
        1 as level  -- éšå±¤ãƒ¬ãƒ™ãƒ«ï¼ˆç›´å±ã®éƒ¨ä¸‹ã¯1ï¼‰
    FROM users
    WHERE manager_id = 1
    
    UNION ALL
    
    -- å†å¸°ãƒ¡ãƒ³ãƒãƒ¼: å‰å›å–å¾—ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®éƒ¨ä¸‹ã‚’ã•ã‚‰ã«å–å¾—
    SELECT 
        u.id,
        u.name,
        u.manager_id,
        s.level + 1 as level  -- éšå±¤ãƒ¬ãƒ™ãƒ«ã‚’1ã¤æ·±ãã™ã‚‹
    FROM users u
    INNER JOIN subordinates s ON u.manager_id = s.id
)
-- éšå±¤é †ã«ã‚½ãƒ¼ãƒˆã—ã¦è¡¨ç¤º
-- level ASC: ç›´å±ã®éƒ¨ä¸‹ â†’ å­« â†’ æ›¾å­« ã®é †
SELECT * 
FROM subordinates
ORDER BY level, id;
```

---

## ğŸ”§ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ã‚³ãƒ¡ãƒ³ãƒˆ

### 1. ã‚¯ã‚¨ãƒªæœ€é©åŒ–

```sql
-- ã€æœ€é©åŒ–å‰ã€‘N+1å•é¡ŒãŒç™ºç”Ÿã™ã‚‹ã‚¯ã‚¨ãƒª
-- å•é¡Œç‚¹: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«ãƒ«ãƒ¼ãƒ—å†…ã§æ³¨æ–‡ã‚’å–å¾—ã™ã‚‹ã¨ã€
-- 1000äººã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¯¾ã—ã¦1001å›ã®ã‚¯ã‚¨ãƒªãŒç™ºè¡Œã•ã‚Œã‚‹
-- SELECT * FROM users;  -- 1å›
-- SELECT * FROM orders WHERE user_id = ?;  -- 1000å›

-- ã€æœ€é©åŒ–å¾Œã€‘JOINã§1å›ã®ã‚¯ã‚¨ãƒªã«çµ±åˆ
-- åŠ¹æœ: ã‚¯ã‚¨ãƒªå›æ•°ã‚’ 1001å› â†’ 1å› ã«å‰Šæ¸›
-- ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ : 5000ms â†’ 50ms ã«æ”¹å–„
SELECT 
    u.id,
    u.name,
    o.id as order_id,
    o.total_amount
FROM users u
LEFT JOIN orders o ON u.id = o.user_id
WHERE u.status = 'active';
```

---

### 2. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ´»ç”¨

```sql
-- ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ´»ç”¨ã™ã‚‹ã‚¯ã‚¨ãƒªã€‘
-- å‰æ: users(status, last_login) ã«è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå­˜åœ¨
-- 
-- ã‚¯ã‚¨ãƒªæœ€é©åŒ–ã®ãƒã‚¤ãƒ³ãƒˆ:
-- 1. WHEREå¥ã§ status ã‚’æŒ‡å®šï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ç¬¬1ã‚«ãƒ©ãƒ ï¼‰
-- 2. ORDER BY ã§ last_login ã‚’ä½¿ç”¨ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ç¬¬2ã‚«ãƒ©ãƒ ï¼‰
-- 3. ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ã®ã¿ã§çµæœã‚’å–å¾—ï¼ˆãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ä¸è¦ï¼‰
-- 
-- EXPLAINçµæœ:
-- type: refï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨ï¼‰
-- rows: ç´„1000ä»¶ï¼ˆãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ãªã‚‰100ä¸‡ä»¶ï¼‰
SELECT id, name, last_login
FROM users
WHERE status = 'active'
ORDER BY last_login ASC
LIMIT 100;
```

---

## ğŸš« é¿ã‘ã‚‹ã¹ããƒ‘ã‚¿ãƒ¼ãƒ³

### 1. ã‚³ãƒ¼ãƒ‰ã®ç¹°ã‚Šè¿”ã—

```sql
-- âŒ æ‚ªã„ä¾‹: SQLã‚’ãã®ã¾ã¾æ—¥æœ¬èªã«ç¿»è¨³ã—ãŸã ã‘
-- usersãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰emailã‚’é¸æŠ
SELECT email FROM users;

-- âœ… è‰¯ã„ä¾‹: WHYã‚’èª¬æ˜
-- ãƒ¡ãƒ¼ãƒ«é…ä¿¡ã®ãŸã‚ã€å…¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—
-- ç†ç”±: ãƒ¡ãƒ¼ãƒ«é…ä¿¡ã‚·ã‚¹ãƒ†ãƒ ã¯ email ã®ãƒªã‚¹ãƒˆã®ã¿ã‚’å¿…è¦ã¨ã™ã‚‹
SELECT email 
FROM users 
WHERE status = 'active';
```

---

## âœ… ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

SQLã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚ã«ç¢ºèª:

- [ ] ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã®å„ã‚«ãƒ©ãƒ ã«èª¬æ˜ãŒã‚ã‚‹
- [ ] ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä½œæˆç†ç”±ãŒæ˜è¨˜ã•ã‚Œã¦ã„ã‚‹
- [ ] è¤‡é›‘ãªã‚¯ã‚¨ãƒªã®å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆJOINã€WHEREã€HAVINGç­‰ï¼‰ã«èª¬æ˜ãŒã‚ã‚‹
- [ ] ã‚µãƒ–ã‚¯ã‚¨ãƒªãƒ»ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é–¢æ•°ã®ä½¿ç”¨ç†ç”±ãŒèª¬æ˜ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®æ„å›³ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹
- [ ] ã™ã¹ã¦ã®ã‚³ãƒ¡ãƒ³ãƒˆãŒæ—¥æœ¬èªã§è¨˜è¿°ã•ã‚Œã¦ã„ã‚‹

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [00-inline-comment-standards.md](../00-inline-comment-standards.md) - å…±é€šåŸå‰‡
- [sql-coding-standards.md](sql-coding-standards.md) - SQLå…¨ä½“ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„
