# インラインコメント規約（共通）
## Inline Comment Standards - Common Principles

**最終更新日**: 2025-11-14  
**バージョン**: 1.0.0  
**対象**: 全プログラミング言語共通  
**言語**: 日本語（必須）

---

## 目的

このドキュメントは、コード内のインラインコメント（実装内部のコメント）に関する共通規約を定義し、
**コメントだけを読んでもロジックの意図・理由・背景が理解できる**状態を実現します。

言語固有の実装例については、各言語別のドキュメントを参照してください。

---

## 1. 基本原則

### 1.1 言語規定

**【重要】すべてのインラインコメントは日本語で記述すること（必須）**

**理由**:
- チーム全体の理解促進（日本語話者が主体）
- ビジネス要件・背景の正確な伝達
- 保守性・可読性の向上

**例外**:
- TODOコメント内のチケット番号・タグは英語可（例: `TODO: JIRA-1234`）
- 技術的な専門用語は英語併記可（例: `トランザクション (Transaction)`）

---

### 1.2 WHYを書く、WHATは書かない

**基本思想**: コードは「何をするか (WHAT)」、コメントは「なぜそうするか (WHY)」を説明

**Good例**:
```
# パフォーマンス最適化: キャッシュから取得することで、
# DB負荷を軽減（100ms → 5ms に改善、要件: PERF-2024-01）
```

**Bad例**:
```
# ユーザーIDからユーザーを取得（コードを見れば分かる）
```

---

### 1.3 複雑度10以上 or ビジネスロジックで必須

**判断基準**:
- **循環的複雑度が10以上**のロジック → コメント必須
- **ビジネスルール・制約**を反映した実装 → コメント必須
- それ以外 → 自己文書化コード（変数名・関数名）で対応

---

## 2. コメントを書くべき判断基準

### 2.1 YESの場合（コメント必須）

以下のいずれかに該当する場合、**日本語で**コメントを記述すること:

- [ ] **複雑なビジネスロジック**の実装
- [ ] **6ヶ月後の自分**が「なぜこうしたか」を忘れる可能性がある
- [ ] **コードレビュアーが「なぜ？」**と質問しそう
- [ ] **ビジネス要件・仕様の制約**を反映している
- [ ] **パフォーマンス最適化**の理由（なぜこの実装を選んだか）
- [ ] **外部システム・API連携**部分（仕様・制約の説明）
- [ ] **バグ修正・回避策**（なぜこの対処が必要か）
- [ ] **技術的負債**（TODO/FIXME/HACK）

### 2.2 NOの場合（コメント不要）

以下の場合はコメント不要、自己文書化コードで対応:

- [ ] コードを読めば明白（例: `get_user_by_id()` など）
- [ ] 標準的なデザインパターンの適用
- [ ] 単純なゲッター/セッター
- [ ] 自己説明的な変数名・関数名

---

## 3. 技術的負債の明示（TODO/FIXME/HACK）

### 3.1 TODOコメント

**書式**:
```
// TODO: <内容>（<チケット番号>）
// - 現状: <現在の実装>
// - 改善案: <どう改善するか>
// - 優先度: 高/中/低
// - 期限: YYYY-QX
```

### 3.2 FIXMEコメント

**書式**:
```
// FIXME: <問題点>（<チケット番号>）
// - 問題: <何が問題か>
// - 影響: <どういう影響があるか>
// - 対処: <どう修正するか>
```

### 3.3 HACKコメント

**書式**:
```
// HACK: <回避策>
// - 問題: <本来の問題>
// - 原因: <なぜこの回避策が必要か>
// - 対処: <どう回避しているか>
// - 削除予定: <いつ削除するか>
```

---

## 4. コメントの種類と用途

### 4.1 ビジネスロジックのコメント

**目的**: ビジネスルール・制約・背景を説明

**記載内容**:
- ビジネス要件ID（例: BIZ-2024-05）
- ルールの内容
- 例外条件
- 施策の背景

### 4.2 パフォーマンス最適化のコメント

**目的**: 最適化の理由と効果を記録

**記載内容**:
- 最適化前後の性能比較
- 要件（応答時間など）
- 実測データ
- 選択したアルゴリズム・手法の理由

### 4.3 外部システム連携のコメント

**目的**: 仕様・制約・注意事項を明記

**記載内容**:
- API仕様バージョン
- タイムアウト・リトライ設定
- エラーハンドリング方針
- 参考ドキュメント

### 4.4 ブラウザ互換性・回避策のコメント

**目的**: ブラウザバグ・互換性対応の理由を記録

**記載内容**:
- 対象ブラウザ・バージョン
- 問題の詳細
- 回避策の内容
- 参考URL（バグレポートなど）
- 削除予定時期

---

## 5. Devin AI への指示

### 5.1 コード生成時の指示

**Devin指示**: 
- すべてのインラインコメントは**日本語で記述**すること
- 複雑度10以上またはビジネスロジックには**必ずコメント**を付与せよ
- コメントは**WHY（なぜ）を重視**し、WHAT（何を）は書かないこと
- TODO/FIXME/HACKは**必ず構造化形式**で記述せよ

### 5.2 コードレビュー時のチェック項目

- [ ] 日本語でコメントが記述されているか
- [ ] 複雑なビジネスロジックにコメントがあるか
- [ ] パフォーマンス最適化の理由が明記されているか
- [ ] 外部システム連携部分に制約・仕様の説明があるか
- [ ] TODO/FIXME/HACKが構造化形式で記述されているか

---

## 6. まとめ

### 6.1 核心原則（5原則）

1. **日本語で記述（必須）** - すべてのインラインコメントは日本語
2. **WHYを書く、WHATは書かない** - 理由・背景・制約を説明
3. **複雑度10以上 or ビジネスロジックで必須** - それ以外は自己文書化
4. **6ヶ月後の自分が理解できるか** - これが判断基準の基本
5. **技術的負債を明確に** - TODO/FIXME/HACKは構造化形式で

### 6.2 言語別ドキュメント

具体的な実装例については、各言語別のドキュメントを参照してください:

- Python: `python/inline-comment-examples.md`
- Java: `java/inline-comment-examples.md`
- TypeScript: `typescript/inline-comment-examples.md`
- SQL: `sql/inline-comment-examples.md`
- CSS/SCSS: `css/inline-comment-examples.md`

---

**改訂履歴**:
- 2025-11-14: v1.0.0 初版作成

