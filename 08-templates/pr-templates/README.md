# PRテンプレート使用ガイド

## 📋 目次
- [概要](#概要)
- [テンプレート一覧](#テンプレート一覧)
- [配置方法](#配置方法)
- [使用方法](#使用方法)
- [カスタマイズ](#カスタマイズ)

---

## 概要

このディレクトリには、プルリクエスト（PR）作成時に使用するテンプレート集が格納されています。

### 目的
- **標準化**: 組織全体で統一されたPR形式
- **品質向上**: 必須項目の記載漏れ防止
- **日本語化**: PR説明文の日本語記載を促進
- **効率化**: テンプレートに従うだけで標準的なPR作成

### 重要事項

#### 1. 日本語記載必須
⚠️ **PRの説明文は日本語で記載することが必須です**。英語での記載は組織標準に準拠しておらず、CI品質ゲート「PR Language Check」で自動的に却下されます。

#### 2. 記載レベル品質保証
⚠️ **PRの説明文は組織標準の記載レベルを満たすことが必須です**。CI品質ゲート「PR Description Quality Gate」が以下を自動検証します：

**検証項目**:
- ✅ **必須セクション7つの存在**: 変更内容の概要、関連チケット、変更の詳細、テストの実施状況、セキュリティチェック、組織標準チェックリスト、レビュアーへの補足
- ✅ **変更内容の概要**: 50文字以上（推奨100文字以上）
- ✅ **チェックボックス確認率**: 70%以上（推奨85%以上）
- ✅ **日本語記載**: 日本語文字を含む
- ✅ **関連チケット番号**: 形式チェック（#123, PBI-456等）

**未達時の動作**:
- ❌ CI失敗ステータス（マージをブロック）
- 💬 詳細なコメント投稿（具体的な改善点を明示）
- 🏷️ ラベル追加: `pr-description-incomplete`
- 📊 統計情報の表示（現在の記載状況）

**詳細ドキュメント**: [PR記載レベル自動チェック実装ガイド](../ci-templates/github-actions/pr-description-quality-gate.md)

---

## テンプレート一覧

### 1. PULL_REQUEST_TEMPLATE.md（デフォルト）
**用途**: すべてのPRに適用されるデフォルトテンプレート

**含まれる項目**:
- 変更内容の概要（必須）
- 関連チケット
- 変更の詳細（機能追加/バグ修正/リファクタリング）
- テストの実施状況
- スクリーンショット
- レビュアーへの補足
- セキュリティチェック
- パフォーマンスへの影響
- ドキュメント更新
- 組織標準チェックリスト
- 関連ドキュメント

**適用対象**: すべてのPR

---

### 2. PULL_REQUEST_TEMPLATE_FEATURE.md（機能追加用）
**用途**: 新機能追加時の専用テンプレート

**デフォルトとの違い**:
- 機能仕様の詳細記載欄を追加
- ユーザーストーリーの記載欄を追加
- 機能デモのセクションを追加

**適用対象**: 新機能追加PR

**使用方法**:
PR作成時にURLパラメータで指定：
```
?template=PULL_REQUEST_TEMPLATE_FEATURE.md
```

---

### 3. PULL_REQUEST_TEMPLATE_BUGFIX.md（バグ修正用）
**用途**: バグ修正時の専用テンプレート

**デフォルトとの違い**:
- バグの詳細記載欄を追加
- 再現手順の記載欄を追加
- 根本原因分析の記載欄を追加
- 修正内容の詳細記載欄を強化

**適用対象**: バグ修正PR

**使用方法**:
PR作成時にURLパラメータで指定：
```
?template=PULL_REQUEST_TEMPLATE_BUGFIX.md
```

---

## 配置方法

### プロジェクトへの配置

#### オプション1: デフォルトテンプレートのみ使用
```bash
# プロジェクトルートに配置
cp PULL_REQUEST_TEMPLATE.md <project-root>/.github/PULL_REQUEST_TEMPLATE.md
```

#### オプション2: 複数テンプレート使用
```bash
# プロジェクトルートに.githubディレクトリを作成
mkdir -p <project-root>/.github/PULL_REQUEST_TEMPLATE

# すべてのテンプレートをコピー
cp PULL_REQUEST_TEMPLATE*.md <project-root>/.github/PULL_REQUEST_TEMPLATE/
```

#### ディレクトリ構造（オプション2の場合）
```
<project-root>/
├── .github/
│   ├── PULL_REQUEST_TEMPLATE/
│   │   ├── PULL_REQUEST_TEMPLATE.md
│   │   ├── PULL_REQUEST_TEMPLATE_FEATURE.md
│   │   └── PULL_REQUEST_TEMPLATE_BUGFIX.md
│   └── workflows/
│       └── pr-language-check.yaml
```

---

## 使用方法

### デフォルトテンプレート使用時

1. **PR作成ページに移動**
   - GitHubで「New pull request」をクリック

2. **テンプレート自動適用**
   - PR説明文欄にテンプレートが自動的に表示される

3. **テンプレートに従って記入**
   - 各項目を日本語で記入
   - チェックリストをすべて完了

4. **PR作成**
   - 「Create pull request」をクリック

---

### 特定のテンプレート使用時

#### GitHub UIから選択
1. **PR作成ページに移動**
2. **「Preview」タブの右側**に「Choose a template」ボタンが表示
3. **テンプレートを選択**
   - デフォルト
   - 機能追加（FEATURE）
   - バグ修正（BUGFIX）
4. **テンプレートに従って記入**

#### URLパラメータで指定
```
# 機能追加テンプレート
https://github.com/<owner>/<repo>/compare/<branch>?template=PULL_REQUEST_TEMPLATE_FEATURE.md

# バグ修正テンプレート
https://github.com/<owner>/<repo>/compare/<branch>?template=PULL_REQUEST_TEMPLATE_BUGFIX.md
```

---

## Devinでの使用方法

### Devinにテンプレートを使わせる

#### 方法1: プロジェクトにテンプレートを配置（推奨）
```bash
# プロジェクトに配置すれば、Devinが自動的に使用
cp PULL_REQUEST_TEMPLATE.md <project-root>/.github/PULL_REQUEST_TEMPLATE.md
```

#### 方法2: タスク指示時に明示
```
【タスク】ユーザー認証機能を実装してください。

【重要】
- PRの説明文は日本語で記載してください
- PRテンプレート（.github/PULL_REQUEST_TEMPLATE.md）に従ってください
- すべてのチェックリスト項目を完了してください
```

#### 方法3: 組織標準ドキュメントを参照させる
```
【参照】
- Phase 3実装ガイド
- Phase 4レビューガイド
- PRテンプレート（.github/PULL_REQUEST_TEMPLATE.md）

【重要】
上記のドキュメントに従って、日本語でPRを作成してください。
```

---

## カスタマイズ

### プロジェクト固有のカスタマイズ

テンプレートはプロジェクトのニーズに合わせてカスタマイズ可能です。

#### カスタマイズ例1: セキュリティ重視プロジェクト
```markdown
## 🔒 セキュリティチェック（詳細版）

- [ ] OWASP Top 10の脆弱性チェックを実施した
- [ ] 機密情報（パスワード、APIキー、トークン）がコードに含まれていない
- [ ] 環境変数で機密情報を管理している
- [ ] 外部入力の適切なバリデーションを実装した
- [ ] SQLインジェクション対策を実施した
- [ ] XSS対策を実施した
- [ ] CSRF対策を実施した
- [ ] 認証・認可の要件を満たしている
- [ ] セキュリティスキャンツールを実行した
```

#### カスタマイズ例2: パフォーマンス重視プロジェクト
```markdown
## 📊 パフォーマンスへの影響（詳細版）

### 計測結果
- [ ] レスポンスタイム: _____ms（目標: <200ms）
- [ ] スループット: _____req/s（目標: >1000req/s）
- [ ] メモリ使用量: _____MB（目標: <500MB）
- [ ] CPU使用率: _____%（目標: <80%）

### 最適化実施内容
- [ ] データベースクエリを最適化した
- [ ] N+1問題を解決した
- [ ] 不要なAPIコールを削減した
- [ ] キャッシュ戦略を実装した
- [ ] レスポンスのgzip圧縮を有効化した
```

#### カスタマイズ例3: フロントエンド重視プロジェクト
```markdown
## 🎨 UI/UX チェック

### アクセシビリティ
- [ ] キーボードナビゲーション対応
- [ ] スクリーンリーダー対応
- [ ] カラーコントラスト比の確認（WCAG AA基準）
- [ ] ARIAラベルの適切な使用

### レスポンシブデザイン
- [ ] モバイル表示確認（320px-）
- [ ] タブレット表示確認（768px-）
- [ ] デスクトップ表示確認（1024px-）

### ブラウザ互換性
- [ ] Chrome（最新版）
- [ ] Firefox（最新版）
- [ ] Safari（最新版）
- [ ] Edge（最新版）
```

---

## ベストプラクティス

### PRタイトルの書き方

#### ✅ 良い例
```
ユーザー認証機能の実装
ログイン画面のバグ修正
パフォーマンス改善: データベースクエリの最適化
```

#### ❌ 悪い例
```
Implement user authentication
Fix bug
Update code
```

---

### PR説明文の書き方

#### ✅ 良い例
```markdown
## 変更内容の概要
JWT（JSON Web Token）を使用したユーザー認証機能を実装しました。
OAuth 2.0プロトコルに準拠し、セキュアなトークン管理を実現しています。

## 追加された機能
- ログインAPI（POST /api/auth/login）の実装
- トークンリフレッシュ機能の追加
- セッション管理の実装

## テスト結果
- 単体テストカバレッジ: 95%
- 統合テスト: すべて合格
- セキュリティテスト: 脆弱性なし
```

#### ❌ 悪い例
```markdown
## Summary
Implemented user authentication using JWT.

## Features
- Login API
- Token refresh
- Session management
```

**違い**: 良い例は文章が日本語で、技術用語（JWT、OAuth、API等）は英語のまま。これがベストプラクティスです。

---

## FAQ

### Q1: テンプレートは必須ですか？
**A**: はい、組織標準として必須です。PR作成時は必ずテンプレートに従ってください。

### Q2: テンプレートの項目をスキップできますか？
**A**: 該当しない項目は「該当なし」と記載するか、空欄でも構いません。ただし、必須項目（変更内容の概要、テスト結果等）は必ず記入してください。

### Q3: テンプレートが自動的に表示されません
**A**: 以下を確認してください：
- テンプレートファイルが`.github/`ディレクトリに配置されているか
- ファイル名が正しいか（`PULL_REQUEST_TEMPLATE.md`）
- ブランチが最新か

### Q4: 英語でPRを書いてしまいました
**A**: CI品質ゲートが自動的に検出します。botコメントの指示に従って、日本語に修正してください。

### Q5: カスタマイズしたテンプレートを組織全体で共有したい
**A**: このディレクトリのテンプレートを更新し、PRを作成してください。承認後、組織全体に反映されます。

---

## 関連ドキュメント

- [PR言語問題の解決策](../../00-guides/PR-LANGUAGE-ISSUE-SOLUTION.md)
- [Phase 4レビューガイド](../../00-guides/phase-guides/phase-4-review-qa-guide.md)
- [AI-PRE-WORK-CHECKLIST](../../00-guides/AI-PRE-WORK-CHECKLIST.md)
- [コーディング規約](../../01-coding-standards/)

---

**このドキュメントは組織標準の一部です。テンプレートの改善提案は Issue で受け付けています。**
